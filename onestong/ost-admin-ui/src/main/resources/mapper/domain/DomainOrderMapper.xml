<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.oz.onestong.dao.domain.DomainOrderMapper" >
  <resultMap id="BaseResultMap" type="com.oz.onestong.model.domain.DomainOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    <id column="doId" property="doId" jdbcType="INTEGER" />
    <result column="doSum" property="doSum" jdbcType="INTEGER" />
    <result column="domainId" property="domainId" jdbcType="INTEGER" />
    <result column="valid" property="valid" jdbcType="TINYINT" />
    <result column="optional1" property="optional1" jdbcType="VARCHAR" />
    <result column="optional2" property="optional2" jdbcType="VARCHAR" />
    <result column="optional3" property="optional3" jdbcType="VARCHAR" />
    <result column="orderCreator" property="creator" jdbcType="VARCHAR" />
    <result column="orderUpdator" property="updator" jdbcType="VARCHAR" />
    <result column="orderCreateTime" property="createTime" jdbcType="TIMESTAMP" />
    <result column="orderUpdateTime" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="orderStartTime" property="startTime" jdbcType="TIMESTAMP" />
    <result column="orderEndTime" property="endTime" jdbcType="TIMESTAMP" />
    
    <collection property="details" ofType="com.oz.onestong.model.domain.DomainOrderDetail">
    <id property="odId" column="odId"/>
    <result property="orderId" column="orderId"/>
    <result property="odSum" column="detailSum"/>
    <result property="creator" column="detailCreator"/>
    <result property="updator" column="detailUpdator"/>
    <result property="createTime" column="detailCreateTime"/>
    <result property="updateTime" column="detailUpdateTime"/>
  </collection>
    
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    do_id, do_sum, domain_id, valid, optional1, optional2, optional3, creator, updator, 
    create_time, update_time, start_time, end_time
  </sql>
  
  
  <select id="selectByDomainId" parameterType="map" resultMap="BaseResultMap"  >
  
  	select  dos.do_id as doId, dos.do_sum as doSum,
dos.domain_id as domainId,
dos.creator as orderCreator,
dos.updator as orderUpdator,
dos.create_time as orderCreateTime,
dos.update_time as orderUpdateTime,
dos.start_time as orderStartTime,
dos.end_time as orderEndTime,

od.od_id as odId,
od.order_id as orderId,
od.od_sum as  detailSum,
od.creator as detailCreator,
od.updator as detailUpdator,
od.create_time as detailCreateTime,
od.update_time as detailUpdateTime

  from domain_orders  as  dos left join orders_detail  as od on    od.order_id = dos.do_id     where  dos.domain_id =#{domainId,jdbcType=INTEGER} and dos.valid = 0  order by od.update_time desc
  
  
  </select>
  
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from domain_orders
    where do_id = #{doId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    delete from domain_orders
    where do_id = #{doId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.oz.onestong.model.domain.DomainOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="doId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into domain_orders (do_sum, domain_id, valid, 
      optional1, optional2, optional3, 
      creator, updator, create_time, 
      update_time, start_time, end_time
      )
    values (#{doSum,jdbcType=INTEGER}, #{domainId,jdbcType=INTEGER}, #{valid,jdbcType=TINYINT}, 
      #{optional1,jdbcType=VARCHAR}, #{optional2,jdbcType=VARCHAR}, #{optional3,jdbcType=VARCHAR}, 
      #{creator,jdbcType=VARCHAR}, #{updator,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, 
      #{updateTime,jdbcType=TIMESTAMP}, #{startTime,jdbcType=TIMESTAMP}, #{endTime,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.oz.onestong.model.domain.DomainOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="doId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into domain_orders
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="doSum != null" >
        do_sum,
      </if>
      <if test="domainId != null" >
        domain_id,
      </if>
      <if test="valid != null" >
        valid,
      </if>
      <if test="optional1 != null" >
        optional1,
      </if>
      <if test="optional2 != null" >
        optional2,
      </if>
      <if test="optional3 != null" >
        optional3,
      </if>
      <if test="creator != null" >
        creator,
      </if>
      <if test="updator != null" >
        updator,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
      <if test="updateTime != null" >
        update_time,
      </if>
      <if test="startTime != null" >
        start_time,
      </if>
      <if test="endTime != null" >
        end_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="doSum != null" >
        #{doSum,jdbcType=INTEGER},
      </if>
      <if test="domainId != null" >
        #{domainId,jdbcType=INTEGER},
      </if>
      <if test="valid != null" >
        #{valid,jdbcType=TINYINT},
      </if>
      <if test="optional1 != null" >
        #{optional1,jdbcType=VARCHAR},
      </if>
      <if test="optional2 != null" >
        #{optional2,jdbcType=VARCHAR},
      </if>
      <if test="optional3 != null" >
        #{optional3,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="updator != null" >
        #{updator,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="startTime != null" >
        #{startTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null" >
        #{endTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.oz.onestong.model.domain.DomainOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    update domain_orders
    <set >
      <if test="doSum != null" >
        do_sum = #{doSum,jdbcType=INTEGER},
      </if>
      <if test="domainId != null" >
        domain_id = #{domainId,jdbcType=INTEGER},
      </if>
      <if test="valid != null" >
        valid = #{valid,jdbcType=TINYINT},
      </if>
      <if test="optional1 != null" >
        optional1 = #{optional1,jdbcType=VARCHAR},
      </if>
      <if test="optional2 != null" >
        optional2 = #{optional2,jdbcType=VARCHAR},
      </if>
      <if test="optional3 != null" >
        optional3 = #{optional3,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        creator = #{creator,jdbcType=VARCHAR},
      </if>
      <if test="updator != null" >
        updator = #{updator,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null" >
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="startTime != null" >
        start_time = #{startTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null" >
        end_time = #{endTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where do_id = #{doId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.oz.onestong.model.domain.DomainOrder" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Jan 11 12:29:44 CST 2015.
    -->
    update domain_orders
    set do_sum = #{doSum,jdbcType=INTEGER},
      domain_id = #{domainId,jdbcType=INTEGER},
      valid = #{valid,jdbcType=TINYINT},
      optional1 = #{optional1,jdbcType=VARCHAR},
      optional2 = #{optional2,jdbcType=VARCHAR},
      optional3 = #{optional3,jdbcType=VARCHAR},
      creator = #{creator,jdbcType=VARCHAR},
      updator = #{updator,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      update_time = #{updateTime,jdbcType=TIMESTAMP},
      start_time = #{startTime,jdbcType=TIMESTAMP},
      end_time = #{endTime,jdbcType=TIMESTAMP}
    where do_id = #{doId,jdbcType=INTEGER}
  </update>
</mapper>